# 费率模型

Gas是衡量交易需要消耗多少资源的单位。Gas上限用`--gas`指定。Gas上限太小时，不够交易需要的Gas。推荐将Gas上限设置为200000，实际消耗多少Gas就会花多少相应的交易费，剩余的交易费会被退还；
GasPrice是每个Gas需要支付的dip数量。GasPrice低于6*10^6pdip，验证人节点也不会执行这笔交易。

:::tip
个别交易需要消耗的gas较多（如创建验证人等），此时建议设置`--gas=400000 --gasprice=6000000.0pdip`，以保证交易顺利执行。
:::

## Fee

`Dipper Network`网络中的验证人为了维护自己节点的安全性和网络的正常运行，付出了不小的成本。因此，在`Dipper Network`网络中的各种交易都需要支付一定的交易费。各种交易中的`--fee`选项就是用来指定交易中支付的交易费上限的参数。

## Gas

验证人节点处理不同的交易时需要的资源也不同，例如转账交易需要进行计算、查询和修改较少，而创建验证人需要进行的计算、查询和修改较多。Gas是用来衡量每个交易需要的资源多少，下面给出部分操作需要的Gas数量:

| 操作                       | Gas数量                                        |
| -------------------------- | ---------------------------------------------- |
| 交易上链 | 10*交易数据的大小（以bytes为单位） |
| 进行一次数据库读取数据操作 | 10 + ln(data_length)/ln(1.02)，data_length为读取数据长度（以bytes为单位）|
| 进行一次数据库写入数据操作 | 10 + 10 * ln(data_length)/ln(1.02)，data_length为写入数据长度（以bytes为单位）|
| 进行一次签名验证 | 100 |

一笔交易中各种操作需要的Gas加起来就是这个交易总共需要的Gas。用户可以使用`--gas`参数给自己发起的交易设置这笔交易的Gas上限，如果一笔交易使用的Gas超过了用户设定的Gas上限则交易就无法成功执行，用户的交易费不会被扣除。如果一笔交易使用的Gas未超过用户设定的Gas上限，则交易可能被成功的执行(还需要检查交易是否符合要求)。当交易被成功执行的时候，用户支付的交易费为: 交易费 * 实际消耗的Gas/Gas上限。

:::warning
在用户设置的gas不足的情况下，如果交易在checkTX阶段检查失败，则不会收取fee。如果已经在deliverTX阶段失败，则fee仍然会被扣除。
:::

Gas价格 = 交易费 / Gas上限，代表用户为每个单位的资源消耗支付的Gas价格。

为了使用户支付的交易费维持在一个合理的水平，我们给Gas价格设定了一个下限，6*10^6pdip，Gas价格低于此限制的交易不会被执行。

示例：

```bash
iris send --from <from_address> --to <to_address> --amount 1pdip --gas=100000 --chain-id=irishub --from=<key-name>
```
